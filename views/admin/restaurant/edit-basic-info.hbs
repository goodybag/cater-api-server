{{#extend "page"}}page-restaurant{{/extend}}

{{#extend "body"}}
  <h2>Basic Info</h2>

  <form class="ap-form form-vertical">
    <div class="form-group">
      <label class="control-label" for="input-name">Name
        <span class="help-block">Required</span>
      </label>
      <input type="text" class="form-control" name="name" id="input-name" value="{{restaurant.name}}">
    </div>
    <div class="form-group">
      <label class="control-label" for="input-description">Description
        <span class="help-block">Displayed under the restaurant's name on the menu pages.</span>
      </label>
      <input type="text" class="form-control" name="description" id="input-description" value="{{restaurant.description}}">
    </div>
    <div class="form-group">
      <label class="control-label" for="input-websites">Websites
        <span class="help-block">Separated by comma</span>
      </label>
      <input type="text" class="form-control" name="websites" id="input-websites" value="{{restaurant.websites}}">
    </div>
    <div class="form-group">
      <label class="control-label" for="input-yelp">Yelp Page URL</label>
      <input type="text" class="form-control" name="yelp_business_id" id="input-yelp" value="{{config.yelp.businessBaseUrl}}/{{restaurant.yelp_business_id}}">
    </div>
    <div class="form-group">
      <label class="control-label" for="input-delivery_service_head_count_threshold">Head Count Delivery Service Threshold
        <span class="help-block">Orders with head count below this will be delivered by a courier</span>
      </label>
      <input type="number" class="form-control" name="delivery_service_head_count_threshold" id="input-delivery_service_head_count_threshold" value="{{restaurant.delivery_service_head_count_threshold}}">
    </div>
    <div class="form-group">
      <label class="control-label" for="input-delivery_service_order_amount_threshold">Order Amount Delivery Service Threshold
        <span class="help-block">Orders with order amount below this will be delivered by a courier</span>
      </label>
      <div class="input-group">
        <div class="input-addon">$</div>
        <input
          type="number"
          step="any"
          class="form-control"
          name="delivery_service_order_amount_threshold"
          id="input-delivery_service_order_amount_threshold"
          data-in="dollars"
          data-out="pennies"
          value="{{dollars restaurant.delivery_service_order_amount_threshold}}">
      </div>
    </div>
    <div class="form-group">
      <label class="control-label" for="input-delivery_service_order_total_upperbound">Order Amount Delivery Service Upperbound
        <span class="help-block">Delivery Service Orders with order amount <em>above</em> this will trigger the notifications on the order to stop and wait for Goodybag action</span>
      </label>
      <div class="input-group">
        <div class="input-addon">$</div>
        <input
          type="number"
          step="any"
          class="form-control"
          name="delivery_service_order_total_upperbound"
          id="input-delivery_service_order_total_upperbound"
          data-in="dollars"
          data-out="pennies"
          value="{{dollars restaurant.delivery_service_order_total_upperbound}}">
      </div>
    </div>
    <div class="form-group">
      <label for="region_id_selector" class="control-label">Region</label>
      <select name="region_id" id="region_id_selector" type="number">
        {{#each regions}}
          <option value="{{this.id}}"{{#eq ../restaurant.region_id this.id}} selected="true"{{/eq}}>{{this.name}}</option>
        {{/each}}
      </select>
    </div>
    <div class="form-group">
      <div class="row">
        <div class="col-filepicker-photo">
          <label class="control-label">Logo</label>
          <img class="restaurant-img" data-name="logo_url"
            src="{{#if restaurant.logo_url}}{{restaurant.logo_url}}{{else}}{{config.defaultLogo}}{{/if}}">
          <input type="filepicker" class="form-control btn btn-default btn-block"
            name="logo_url" value="{{#if restaurant.logo_url}}{{restaurant.logo_url}}{{else}}{{config.defaultLogo}}{{/if}}"
            id="input-logo-url">
        </div>
        <div class="col-filepicker-photo">
          <label class="control-label">Monochromatic Logo</label>
          <img class="restaurant-img" data-name="logo_mono_url"
            src="{{#if restaurant.logo_mono_url}}{{restaurant.logo_mono_url}}{{else}}{{config.defaultMonoLogo}}{{/if}}">
          <input type="filepicker" class="form-control btn btn-default btn-block"
            name="logo_mono_url" value="{{#if restaurant.logo_mono_url}}{{restaurant.logo_mono_url}}{{else}}{{config.defaultMonoLogo}}{{/if}}"
            id="input-mono-logo-url">
        </div>
      </div>
      <div class="row">
        <div class="col-filepicker-photo">
          <label class="control-label">List Photo</label>
          <img class="restaurant-img" data-name="list_photo_url"
          src="{{#if restaurant.list_photo_url}}{{restaurant.list_photo_url}}{{else}}{{config.defaultMonoLogo}}{{/if}}">
          <input type="filepicker" class="form-control btn btn-default btn-block"
          name="list_photo_url" value="{{#if restaurant.list_photo_url}}{{restaurant.list_photo_url}}{{else}}{{config.defaultMonoLogo}}{{/if}}"
          id="input-list-photo-url">
        </div>
      </div>
    </div>
    <div class="form-group">
      <label class="control-label" for="input-hidden">
        <input type="checkbox" class="form-control" name="is_hidden" id="input-hidden" {{#if restaurant.is_hidden}}checked="checked"{{/if}}>
        Hidden from listing
      </label>
    </div>
    <div class="form-group">
      <label class="control-label" for="input-disable-notifications">
        <input type="checkbox" class="form-control" name="disable_notifications" id="input-disable-notifications" {{#if restaurant.disable_notifications}}checked="checked"{{/if}}>
        Disable notifications (Goodybag must trigger all notifications manually!)
      </label>
    </div>

    <fieldset id="fieldset-no-contract">
      <h3 class="fieldset-title">Contract Info</h3>
      <div class="form-group" id="has-contract-group">
        <label class="control-label">
          <input type="checkbox" class="form-control" name="has_contract" {{#if restaurant.has_contract}}checked="checked"{{/if}}>
         Has a contract?
        </label>
      </div>
      <div class="form-group" id="no-contract-fee-group">
        <label>No Contract Transaction Fee</label>
        <div class="input-group">
          <input
            type="text"
            class="form-control"
            name="no_contract_fee"
            id="input-no_contract_fee"
            data-in="factorToPercent"
            data-out="percentToFactor 4"
            value="{{factorToPercent restaurant.no_contract_fee}}">
          <div class="input-addon">%</div>
        </div>
      </div>
      <div class="form-group">
        <label class="control-label" for="input-rate">GB Fee</label>
        <div class="input-group">
          <input
            type="text"
            class="form-control"
            name="gb_fee"
            id="input-gb_fee"
            data-in="factorToPercent"
            data-out="percentToFactor 4"
            value="{{factorToPercent restaurant.gb_fee}}">
          <div class="input-addon">%</div>
        </div>
      </div>
    </fieldset>

    <div class="form-group actions">
      <button class="btn-update" type="submit">Update</button>
    </div>
  </form>
{{/extend}}

{{#extend "scripts"}}
<script type="text/javascript" src="//api.filepicker.io/v1/filepicker.js"></script>
<script type="text/javascript">filepicker.setKey('{{config.filepicker.key}}');</script>
<script>
  // Init views on this page
  require( ['app/pages/admin/restaurant/edit-basic-info', 'app/models/restaurant'], function( page, Restaurant ){
    page.init({
      models: { restaurant: new Restaurant({{{json restaurant}}}) }
    });
  });
</script>
{{/extend}}
